@version: 3.3
#
# /etc/syslog-ng/syslog-ng.conf
#
##########################################################
# OPTIONS
#
options {
   create_dirs(yes);
   use_dns(persist_only);
   dns_cache_hosts(/etc/hosts);
   dns_cache_expire(87600);

   # disable the chained hostname format in logs (default is enabled)
   chain_hostnames(0);

   # the number of lines fitting in the output queue
   log_fifo_size(512);

   # enable or disable directory creation for destination files
   create_dirs(yes);

   # default owner, group, and permissions for log files (defaults are 0, 0, 0600)
   owner(root);
   group(sys);
   perm(0640);
   
   # default owner, group, and permissions for created directories (defaults are 0, 0, 0700)
   dir_owner(root);
   dir_group(root);
   dir_perm(0740);       
   
   # the time to wait before a died connection is re-established (default is 60)
   time_reopen(10);

   # the time to wait before an idle destination file is closed (default is 60)
   time_reap(360);

   # default no
   use_fqdn(no);

   keep_hostname(yes);

   # disable stats
   stats_freq(0);

   # Write very so often
   flush_lines(0);

}; 

##########################################################
# SOURCES
#
source local_src {
   # message generated by syslog-ng
   internal();

   # standard Linux log source (this is the default place for the syslog() function to send logs to)
   unix-stream("/dev/log");

   # messages from the kernel
   file("/proc/kmsg" program_override("kernel: "));
};

# source s_syslog { syslog(ip(127.0.0.1) port(1999) transport("tcp")); };
# source s_pipe { pipe("/dev/pipe" pad_size(2048)); };

##########################################################
# DESTINATIONS
#
destination d_file { file("/var/log/$YEAR.$MONTH.$DAY/everything.log" template("$HOUR:$MIN:$SEC [$LEVEL] [$FACILITY] [$PROGRAM] $MSG\n") template_escape(no)); };

destination d_authlog { file("/var/log/auth.log"); };
destination d_syslog { file("/var/log/syslog.log"); };
destination d_cron { file("/var/log/cron.log"); };
destination d_daemon { file("/var/log/daemon.log"); };
destination d_kernel { file("/var/log/kernel.log"); };
destination d_lpr { file("/var/log/lpr.log"); };
destination d_user { file("/var/log/user.log"); };
destination d_uucp { file("/var/log/uucp.log"); };
destination d_ppp { file("/var/log/ppp.log"); };
# Mail
destination d_mail { file("/var/log/mail.log"); };
destination d_mailinfo { file("/var/log/mail.info"); };
destination d_mailwarn { file("/var/log/mail.warn"); };
destination d_mailerr { file("/var/log/mail.err"); };
# News
destination d_news { file("/var/log/news.log"); };
destination d_newscrit { file("/var/log/news/news.crit"); };
destination d_newserr { file("/var/log/news/news.err"); };
destination d_newsnotice { file("/var/log/news/news.notice"); };
# Debug
destination d_debug { file("/var/log/debug"); };
destination d_messages { file("/var/log/messages"); };
# Console Etc
destination d_everything { file("/var/log/everything"); };
destination d_console { usertty("root"); };
destination d_console_all { file("/dev/tty12"); };
destination d_loghost { udp("loghost" port(999)); };
destination d_xconsole { pipe("/dev/xconsole"); };
# Everything Else
destination d_errors { file("/var/log/errors.log"); };
destination d_iptables { file("/var/log/iptables.log"); };
destination d_acpid { file("/var/log/acpid.log"); };
# Log everything to tty12
destination console_all { file("/dev/tty12"); };

##########################################################
# FILTERS
#
filter f_auth { facility(auth); };
filter f_authpriv { facility(auth, authpriv); };
filter f_syslog { program(syslog-ng); };
filter f_cron { facility(cron); };
filter f_daemon { facility(daemon); };
filter f_kernel { facility(kern) and not filter(f_iptables); };
filter f_lpr { facility(lpr); };
filter f_mail { facility(mail); };
filter f_news { facility(news); };
filter f_user { facility(user); };
filter f_uucp { facility(cron); };
filter f_ppp { facility(local2); };
filter f_debug { not facility(auth, authpriv, news, mail); };
filter f_messages { level(info..warn) and not facility(auth, authpriv, mail, news, cron) and not program(syslog-ng) and not filter(f_iptables); };
filter f_everything { level(debug..emerg); };
filter f_emergency { level(emerg); };
filter f_info { level(info); };
filter f_notice { level(notice); };
filter f_warn { level(warn); };
filter f_crit { level(crit); };
filter f_err { level(err); };
filter f_iptables { match("IN=" value("MESSAGE")) and match("OUT=" value("MESSAGE")); };
filter f_acpid { program("acpid"); };
filter f_failed { match("failed" value(MESSAGE)); };
filter f_denied { match("denied" value(MESSAGE)); };

##########################################################
# LOG
#
log { source(local_src); filter(f_syslog); destination(d_syslog); };
log { source(local_src); destination(d_file); };
log { source(local_src); filter(f_acpid); destination(d_acpid); };
log { source(local_src); filter(f_authpriv); destination(d_authlog); };
log { source(local_src); filter(f_user); destination(d_user); };
log { source(local_src); filter(f_cron); destination(d_cron); };
log { source(local_src); filter(f_daemon); destination(d_daemon); };
log { source(local_src); filter(f_kernel); destination(d_kernel); };
log { source(local_src); filter(f_lpr); destination(d_lpr); };
log { source(local_src); filter(f_uucp); destination(d_uucp); };
# Mail
log { source(local_src); filter(f_mail); destination(d_mail); };
log { source(local_src); filter(f_mail); filter(f_info); destination(d_mailinfo); };
log { source(local_src); filter(f_mail); filter(f_warn); destination(d_mailwarn); };
log { source(local_src); filter(f_mail); filter(f_err); destination(d_mailerr); };
# News
log { source(local_src); filter(f_mail); destination(d_mail); };
log { source(local_src); filter(f_news); filter(f_crit); destination(d_newscrit); };
log { source(local_src); filter(f_news); filter(f_err); destination(d_newserr); };
log { source(local_src); filter(f_news); filter(f_notice); destination(d_newsnotice); };
# Etc
log { source(local_src); filter(f_debug); destination(d_debug); };
log { source(local_src); filter(f_messages); destination(d_messages); };
log { source(local_src); filter(f_ppp); destination(d_ppp); };
log { source(local_src); destination(d_messages); };
log { source(local_src); filter(f_err); destination(d_errors); };
log { source(local_src); filter(f_emergency); destination(d_console); };
log { source(local_src); filter(f_everything); destination(d_everything); };
log { source(local_src); filter(f_iptables); destination(d_iptables); };
# Log everything to tty12
log { source(local_src); destination(console_all); };
